<app-header-page titlePage="{{ 'admin.register-video.title' | translate }}" [breadcrumb]="breadcrumb"></app-header-page>

<div class="container">
  <div class="row">
    <h1>{{ 'admin.register-video.sendYourProject' | translate }}</h1>
  </div>
  <div class="row">
  </div>
  <div class="row" *ngIf="!showFormVideo">
    <div class="col-md-12">
      <div class="upload-box">
        <div class="upload-box__content">
          <div class="upload-box__content__drop-container" ngFileDrop [options]="options"
               (uploadOutput)="onUploadOutput($event)" [uploadInput]="uploadInput">
            <div class="middle-info">
              <div class="back-text">{{ 'admin.register-video.deposeProject' | translate }}</div>

              <input type="file" ngFileSelect [options]="options" #selectVideo
                     (uploadOutput)="onUploadOutput($event)" [uploadInput]="uploadInput"
                     multiple accept="video/mp4, video/webm">

              <button (click)="selectVideo.click()">{{ 'admin.register-video.selectProject' | translate }}</button>
            </div>
          </div>
          <div class="upload-box__content__items" *ngFor="let f of files; let i = index;">
            <div class="upload-box__content__items__content">
              <div class="upload-box__content__items__content__filename">
                <div class="filename-left float-left">
                  <i class="fas fa-file-upload"></i>&nbsp;&nbsp;
                  <span>{{ f.name }}</span>
                </div>
                <div class="filename-right">
                  <i class="fas fa-times-circle" *ngIf="f?.progress?.data?.percentage>0" (click)="cancelUpload(f.id)"></i>
                  <i class="fas fa-times-circle" *ngIf="f?.progress?.data?.percentage===0" (click)="removeFile(f.id)"></i>
                </div>
              </div>
              <div class="upload-box__content__items__content__progress-content">
                <div class="progress">
                  <div class="progress-bar progress-bar-striped progress-bar-animated" role="progressbar"
                       [style.width]="f?.progress?.data?.percentage + '%'"
                       [class.is-done]="f?.progress?.data?.percentage === 100"></div>
                </div>
              </div>
              <div class="upload-box__content__items__content__progress-text-content">
                <span class="progress-text" [class.is-done]="f?.progress?.data?.percentage === 100">
                  <span>{{ f.progress?.data?.percentage }}% </span>
                  <span *ngIf="f.progress?.data?.percentage !== 100">
                    {{ 'admin.register-video.uploading' | translate }}
                  </span>
                  <span *ngIf="f.progress?.data?.percentage === 100">
                    {{ 'admin.register-video.done' | translate }}
                  </span>
                </span>
                <span class="speed-and-eta-text"
                      *ngIf="f.progress?.data?.percentage !== 0 && f.progress?.data?.percentage !== 100">
                  <span>{{ f.progress?.data?.speedHuman }} </span>
                  <span>ETA {{ f.progress?.data?.etaHuman }}</span>
                </span>
              </div>
            </div>
          </div>
        </div>

        <div class="row">
          <div class="col-md-3">
            <button class="btn btn-primary" (click)="startUpload()">{{ 'admin.register-video.send' | translate }}</button>
            &nbsp;&nbsp;
            <button class="btn btn-danger" *ngIf="files.length > 0" (click)="removeAllFiles()">
              {{ 'admin.register-video.deleteAll' | translate }}
            </button>
          </div>
          <div class="col-md-9">
            <div class="text-justify text-danger"
                 *ngFor="let errorMessage of errors">
              {{ errorMessage}}
            </div>
          </div>
        </div>

      </div>
    </div>
  </div>

  <div class="row" *ngIf="showFormVideo">
    <app-update-video-form *ngFor="let video of videos" [video]="video" (formSuccess)="onSuccessForm($event)">
    </app-update-video-form>
  </div>
</div>

